(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3600],{666:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var a=t(5155),r=t(1958),l=t(8340);let i=(0,l.A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),d=(0,l.A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var c=t(4538);let n=(0,l.A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),x=(0,l.A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var o=t(2115);function m(){let[e,s]=(0,o.useState)(null),[t,l]=(0,o.useState)(!0),[m,h]=(0,o.useState)(!1),[p,g]=(0,o.useState)([]),[j,u]=(0,o.useState)("overview"),y=async()=>{try{l(!0);let e=await fetch("/api/admin/maps/stats"),t=await e.json();if(t.success)s(t.stats),g(t.projects);else throw Error(t.error||"Failed to load data")}catch(e){console.error("Error loading map data:",e),s({total:0,withCoordinates:0,withoutCoordinates:0,withPOIs:0,byDeveloper:{},byStatus:{},errors:["Failed to load project data"]})}finally{l(!1)}},b=async()=>{h(!0),await y(),h(!1)};return((0,o.useEffect)(()=>{y()},[]),t)?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(r.A,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),(0,a.jsx)("p",{className:"text-gray-600",children:"جاري تحميل بيانات الخرائط..."})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"\uD83D\uDDFA️ إدارة الخرائط"}),(0,a.jsx)("p",{className:"text-gray-600",children:"مراقبة وإدارة بيانات الخرائط والمواقع الجغرافية للمشاريع"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:b,disabled:m,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[(0,a.jsx)(r.A,{className:`w-4 h-4 ${m?"animate-spin":""}`}),"تحديث البيانات"]}),(0,a.jsxs)("button",{onClick:()=>{if(!e)return;let s=new Blob([JSON.stringify({timestamp:new Date().toISOString(),summary:{total_projects:e.total,projects_with_coordinates:e.withCoordinates,projects_without_coordinates:e.withoutCoordinates,projects_with_pois:e.withPOIs,coverage_percentage:Math.round(e.withCoordinates/e.total*100)},by_developer:e.byDeveloper,by_status:e.byStatus,errors:e.errors},null,2)],{type:"application/json"}),t=URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`map-report-${new Date().toISOString().split("T")[0]}.json`,a.click(),URL.revokeObjectURL(t)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,a.jsx)(i,{className:"w-4 h-4"}),"تصدير التقرير"]})]})]})}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"نظرة عامة",icon:d},{id:"projects",label:"المشاريع",icon:c.A},{id:"errors",label:"الأخطاء",icon:n}].map(e=>(0,a.jsxs)("button",{onClick:()=>u(e.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm ${j===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[(0,a.jsx)(e.icon,{className:"w-4 h-4"}),e.label]},e.id))})})}),"overview"===j&&e&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"إجمالي المشاريع"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.total})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(d,{className:"w-6 h-6 text-blue-600"})})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"مع إحداثيات"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:e.withCoordinates}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[Math.round(e.withCoordinates/e.total*100),"% من المجموع"]})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(x,{className:"w-6 h-6 text-green-600"})})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"بدون إحداثيات"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:e.withoutCoordinates}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[Math.round(e.withoutCoordinates/e.total*100),"% من المجموع"]})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(n,{className:"w-6 h-6 text-red-600"})})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"مع نقاط اهتمام"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:e.withPOIs}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[Math.round(e.withPOIs/e.total*100),"% من المجموع"]})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(c.A,{className:"w-6 h-6 text-purple-600"})})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"التوزيع حسب المطور"}),(0,a.jsx)("div",{className:"space-y-3",children:Object.entries(e.byDeveloper).map(([s,t])=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:s}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${t/e.total*100}%`}})}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:t})]})]},s))})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"التوزيع حسب الحالة"}),(0,a.jsx)("div",{className:"space-y-3",children:Object.entries(e.byStatus).map(([s,t])=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:s}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${t/e.total*100}%`}})}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:t})]})]},s))})]})]})]}),"projects"===j&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"قائمة المشاريع"})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المشروع"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المطور"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإحداثيات"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"نقاط الاهتمام"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:p.slice(0,50).map((e,s)=>{let t=e.latitude&&e.longitude&&0!==e.latitude&&0!==e.longitude,r=e.mapPointsOfInterest&&Object.keys(e.mapPointsOfInterest).length>0;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"string"==typeof e.projectName?e.projectName:e.projectName?.ar||e.projectName?.en||"Unknown"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.developer||"Unknown"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:t?(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[(0,a.jsx)(x,{className:"w-3 h-3 mr-1"}),"متوفر"]}):(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[(0,a.jsx)(n,{className:"w-3 h-3 mr-1"}),"غير متوفر"]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:r?(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[Object.keys(e.mapPointsOfInterest).length," فئة"]}):(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"لا توجد"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"string"==typeof e.projectStatus?e.projectStatus:e.projectStatus?.ar||e.projectStatus?.en||"Unknown"})]},s)})})]})})]}),"errors"===j&&e&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"سجل الأخطاء"})}),(0,a.jsx)("div",{className:"p-6",children:e.errors.length>0?(0,a.jsx)("div",{className:"space-y-3",children:e.errors.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-red-50 rounded-lg",children:[(0,a.jsx)(n,{className:"w-5 h-5 text-red-500 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-red-800",children:e}),(0,a.jsx)("p",{className:"text-xs text-red-600 mt-1",children:new Date().toLocaleString("ar-SA")})]})]},s))}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(x,{className:"w-12 h-12 text-green-500 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-600",children:"لا توجد أخطاء مسجلة"})]})})]})]})})}},1958:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(8340).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},4538:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(8340).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},6457:(e,s,t)=>{Promise.resolve().then(t.bind(t,666))},8340:(e,s,t)=>{"use strict";t.d(s,{A:()=>c});var a=t(2115);let r=e=>{let s=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,t)=>t?t.toUpperCase():s.toLowerCase());return s.charAt(0).toUpperCase()+s.slice(1)},l=(...e)=>e.filter((e,s,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===s).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,a.forwardRef)(({color:e="currentColor",size:s=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:d="",children:c,iconNode:n,...x},o)=>(0,a.createElement)("svg",{ref:o,...i,width:s,height:s,stroke:e,strokeWidth:r?24*Number(t)/Number(s):t,className:l("lucide",d),...!c&&!(e=>{for(let s in e)if(s.startsWith("aria-")||"role"===s||"title"===s)return!0})(x)&&{"aria-hidden":"true"},...x},[...n.map(([e,s])=>(0,a.createElement)(e,s)),...Array.isArray(c)?c:[c]])),c=(e,s)=>{let t=(0,a.forwardRef)(({className:t,...i},c)=>(0,a.createElement)(d,{ref:c,iconNode:s,className:l(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,t),...i}));return t.displayName=r(e),t}}},e=>{e.O(0,[8441,3794,7358],()=>e(e.s=6457)),_N_E=e.O()}]);