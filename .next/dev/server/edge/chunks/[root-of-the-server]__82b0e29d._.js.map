{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/i18n-config.ts"],"sourcesContent":["// lib/i18n-config.ts\nexport const i18n = {\n  defaultLocale: 'ar',\n  locales: ['ar', 'en'],\n} as const;\n\nexport type Locale = (typeof i18n)['locales'][number];\n"],"names":[],"mappings":"AAAA,qBAAqB;;;;;AACd,MAAM,OAAO;IAClB,eAAe;IACf,SAAS;QAAC;QAAM;KAAK;AACvB"}},
    {"offset": {"line": 32, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import type { NextRequest } from 'next/server';\nimport { NextResponse } from 'next/server';\nimport { i18n } from './lib/i18n-config';\n\nconst PUBLIC_FILE = /\\.(?:svg|png|jpg|jpeg|gif|webp|ico|txt|xml|mp4|webm|pdf|json)$/i;\n\nfunction getPreferredLocale(request: NextRequest): string {\n  const accept = request.headers.get('accept-language') || '';\n  const primary = accept.split(',')[0]?.split(';')[0]?.toLowerCase() || '';\n  if (primary.startsWith('ar')) return 'ar';\n  if (primary.startsWith('en')) return 'en';\n  return i18n.defaultLocale;\n}\n\nfunction getLocale(request: NextRequest): string {\n  // Check if there is any supported locale in the pathname\n  const pathname = request.nextUrl.pathname;\n  const pathnameIsMissingLocale = i18n.locales.every(\n    (locale) => !pathname.startsWith(`/${locale}/`) && pathname !== `/${locale}`\n  );\n\n  // Redirect if there is no locale\n  if (pathnameIsMissingLocale) {\n    return getPreferredLocale(request);\n  }\n\n  // Extract locale from pathname\n  const segments = pathname.split('/');\n  const localeFromPath = segments[1];\n  \n  // Validate locale\n  if (i18n.locales.includes(localeFromPath as any)) {\n    return localeFromPath;\n  }\n  \n  return i18n.defaultLocale;\n}\n\nexport function middleware(req: NextRequest) {\n  const { pathname } = req.nextUrl;\n\n  // تخطّي الملفات العامة و Next internals و الـ API\n  if (\n    pathname.startsWith('/_next') ||\n    pathname.startsWith('/api') ||\n    pathname.startsWith('/static') ||\n    PUBLIC_FILE.test(pathname) ||\n    pathname === '/favicon.ico' ||\n    pathname === '/robots.txt' ||\n    pathname === '/sitemap.xml'\n  ) {\n    return NextResponse.next();\n  }\n\n  // تحويل الجذر إلى اللغة الافتراضية/المفضلة من المتصفح\n  if (pathname === '/') {\n    const preferred = getPreferredLocale(req);\n    return NextResponse.redirect(new URL(`/${preferred}`, req.url));\n  }\n\n  // Check if there is any supported locale in the pathname\n  const pathnameIsMissingLocale = i18n.locales.every(\n    (locale) => !pathname.startsWith(`/${locale}/`) && pathname !== `/${locale}`\n  );\n\n  // Redirect if there is no locale\n  if (pathnameIsMissingLocale) {\n    const locale = getLocale(req);\n    const cleanPath = pathname.startsWith('/') ? pathname : `/${pathname}`;\n    return NextResponse.redirect(new URL(`/${locale}${cleanPath}`, req.url));\n  }\n\n  // Normalize paths that accidentally include two locale segments (e.g., /en/ar or /ar/en)\n  {\n    const segments = pathname.split('/').filter(Boolean);\n    if (\n      segments.length >= 2 &&\n      i18n.locales.includes(segments[0] as any) &&\n      i18n.locales.includes(segments[1] as any)\n    ) {\n      const rest = segments.slice(2).join('/');\n      const target = `/${segments[1]}${rest ? `/${rest}` : ''}`;\n      return NextResponse.redirect(new URL(target, req.url));\n    }\n  }\n\n  // Generate a per-request nonce using Web Crypto API (Edge-compatible)\n  const nonceArray = new Uint8Array(16);\n  crypto.getRandomValues(nonceArray);\n  // Convert to base64 using btoa (available in Edge runtime)\n  const nonce = btoa(String.fromCharCode(...nonceArray));\n  \n  const cspHeader = `\n    default-src 'self';\n    script-src 'self' 'nonce-${nonce}' 'strict-dynamic' https://www.googletagmanager.com https://www.google-analytics.com https://*.clarity.ms https://scripts.clarity.ms https://unpkg.com https://cdn.jsdelivr.net https://cdn.aframe.io https://api.propvr.tech https://my.matterport.com https://static.matterport.com https://cdn.pannellum.org https://ajax.googleapis.com https://www.youtube.com https://player.vimeo.com;\n    style-src 'self' 'unsafe-inline' https://unpkg.com https://cdn.jsdelivr.net https://fonts.googleapis.com;\n    img-src 'self' data: blob: https: https://images.ctfassets.net https://assets.ctfassets.net https://videos.ctfassets.net https://downloads.ctfassets.net https://cdn.properties.emaar.com https://properties.emaar.com https://sobharealty.com https://www.sobharealty.com https://www.nakheel.com https://nakheel-aut.sitefinity.cloud https://prod-cdn.damacproperties.com https://storage.googleapis.com https://i.ytimg.com https://res.cloudinary.com https://www.google-analytics.com https://*.google.com https://*.google.co.in https://*.clarity.ms;\n    font-src 'self' data: https://fonts.gstatic.com;\n    connect-src 'self' https://aframe.io https://www.google-analytics.com https://*.analytics.google.com https://*.googletagmanager.com https://*.clarity.ms https://api.propvr.tech https://storagecdn.propvr.tech https://cdn.propvr.tech https://propvr-in-31420.appspot.com https://firebasestorage.googleapis.com https://storagecdn.propvr.ai https://my.matterport.com https://static.matterport.com;\n    media-src 'self' blob: https: https://videos.ctfassets.net https://assets.ctfassets.net https://www.youtube.com https://player.vimeo.com;\n    frame-src 'self' https://www.youtube.com https://player.vimeo.com https://my.matterport.com https://www.google.com https://maps.google.com https://view.propvr.tech;\n    child-src 'self' blob:;\n    worker-src 'self' blob:;\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n  `.replace(/\\n/g, ' ').trim();\n\n  const requestHeaders = new Headers(req.headers);\n  requestHeaders.set('x-nonce', nonce);\n\n  const res = NextResponse.next({\n    request: {\n      headers: requestHeaders,\n    },\n  });\n\n  // Set CSP and frame options on the response\n  res.headers.set('Content-Security-Policy', cspHeader);\n  res.headers.set('X-Frame-Options', 'SAMEORIGIN');\n\n  return res;\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     * - public assets\n     */\n    '/((?!api|_next/static|_next/image|favicon.ico|.*\\\\.(?:svg|png|jpg|jpeg|gif|webp|ico|txt|xml|mp4|webm|pdf|json)$).*)',\n  ],\n};\n"],"names":[],"mappings":"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"}}]
}